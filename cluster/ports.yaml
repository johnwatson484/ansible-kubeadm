- hosts: master
  become: yes
  tasks:
    - name: disable ufw
      become: yes
      shell: sudo ufw disable

    - name: reset ufw
      become: yes
      shell: echo "y" | sudo ufw reset

    - name: enable ports
      become: yes
      shell: |
        sudo ufw allow http
        sudo ufw allow https
        sudo ufw allow ssh
        sudo ufw allow 6443/tcp
        sudo ufw allow 2379:2380/tcp
        sudo ufw allow 10250:10260/tcp

    - name: enable ufw
      become: yes
      shell: echo "y" | sudo ufw enable

- hosts: workers
  become: yes
  tasks:
    - name: disable ufw
      become: yes
      shell: sudo ufw disable

    - name: reset ufw
      become: yes
      shell: echo "y" | sudo ufw reset

    - name: enable ports
      become: yes
      shell: |
        sudo ufw allow http
        sudo ufw allow https
        sudo ufw allow ssh
        sudo ufw allow 6443/tcp
        sudo ufw allow 10250:10260/tcp
        sudo ufw allow 30000:60000/tcp

    - name: enable ufw
      become: yes
      shell: echo "y" | sudo ufw enable
